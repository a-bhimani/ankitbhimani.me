var windowHeight,headerHeight,footerHeight,availableWidth,availableHeight,navbarHeight=44,swipePos,resizeGrid=function(){var i,e,t=10;availableWidth>availableHeight?(e=availableHeight-t,i=e):(i=availableWidth-t,e=i);var o=(availableWidth-i)/2,a=(windowHeight+headerHeight-footerHeight-navbarHeight-e)/2;$("#maingrid").css({width:i,height:e,left:o,top:a}),$("#navbar").css("bottom",footerHeight),$(".strip").length>0&&($(".strip").css("top",headerHeight),$(".strip").css("max-height",availableHeight))},randomizeBackground=function(){var i=$("#mainimage .img").size(),e=Math.floor(Math.random()*i)+1,t=$("#mainimage .img:nth-child("+e+")");loadPhoto(t),setBackgroundImage(t)},setBackgroundImage=function(i){var e=$(i).css("background-image");$("#background").css("background-image",e)},gridCascade=function(i){var e,t=function(i){return{left:$(i).offset().top+$(i).height()/2,top:$(i).offset().left+$(i).width()/2}},o=function(i,e){var o=t(i),a=t(e);return Math.sqrt(Math.abs(Math.pow(a.left-o.left,2)+Math.pow(a.top-o.top,2)))},a=i,n=$("#maingrid li");$(n).each(function(){var i=o(a,this);e=e>i?e:i}),$(n).each(function(){var i=o(a,this)/e*500;$(this).attr("style","-webkit-transition-delay: "+i+"ms"),$(this).addClass("flutter")})},clearPhotos=function(){$("#photos .img").css({"background-image":"url()"})},loadPhoto=function(i){$(i).css({"background-image":"url("+$(i).data("image")+")"})},loadPhotos=function(i){clearPhotos(),loadPhoto(i),loadPhoto(i.next().length>0?i.next():$("#photos .img:first-child")),loadPhoto(i.prev().length>0?i.prev():$("#photos .img:last-child"))},resizePhoto=function(i){$(i).css("height",windowHeight)},resizePhotos=function(i){resizePhoto(i),resizePhoto(i.next().length>0?i.next():$("#photos .img:first-child")),resizePhoto(i.prev().length>0?i.prev():$("#photos .img:last-child"))},currentPhoto=function(i){return $("#photos .img:nth-child("+i+")")};$(document).ready(function(){swipePos=1,window.mySwipe=new Swipe(document.getElementById("photos"),{speed:300,continuous:!0,disableScroll:!0,callback:function(){swipePos=mySwipe.getPos()+1,resizePhotos(currentPhoto(swipePos)),loadPhotos(currentPhoto(swipePos))}}),windowHeight=$(window).height(),$("#photos .img").css("height",windowHeight),randomizeBackground(),$(window).load(function(){headerHeight=$("header").outerHeight(),footerHeight=$("footer").outerHeight(),windowHeight=$(window).height(),availableWidth=$(window).width(),availableHeight=windowHeight-(headerHeight+footerHeight+navbarHeight),resizeGrid(),$(".strip").length>0&&($(".strip").css("top",headerHeight),$(".strip").css("max-height",availableHeight))}),$(window).on("resize",function(){headerHeight=$("header").outerHeight(),footerHeight=$("footer").outerHeight(),windowHeight=$(window).height(),availableWidth=$(window).width(),availableHeight=windowHeight-(headerHeight+footerHeight+navbarHeight),$("#mainimage").hasClass("visible")?(windowHeight=$(window).height(),resizePhotos(currentPhoto(swipePos))):resizeGrid()}),$("#maingrid li").click(function(){var i=this;gridCascade(i),$("header").css({"margin-top":0-headerHeight,opacity:0}),$("#navbar, footer").css({"margin-bottom":0-navbarHeight-footerHeight,opacity:0}),$("main").addClass("blackout"),setTimeout(function(){$("#mainimage").addClass("visible");var e=$("#maingrid");if(e.hasClass("home"))var t=0;else var t=e.attr("data-pagenumber")-1;var o=$("li",e).index($(i))+36*t;navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?mySwipe.slide(o,300):mySwipe.slide(o,1),loadPhotos(currentPhoto(swipePos))},500)}),$(".photonav.button").click(function(){$(this).hasClass("next")?mySwipe.next():$(this).hasClass("prev")&&mySwipe.prev()}),$("#photos .img").click(function(){$(".photoinfo").toggleClass("hidden")}),$(".photoinfo a").click(function(i){i.stopPropagation()}),$(".backbutton").click(function(){setBackgroundImage(currentPhoto(swipePos)),resizeGrid(),$("#mainimage").removeClass("visible"),$("header, #navbar, footer").css({margin:0,opacity:1}),$("main").removeClass("blackout"),$("#maingrid li").removeClass("flutter"),setTimeout(function(){$("#maingrid li").css("-webkit-transition-delay","0")},300)}),$(document.documentElement).keydown(function(i){27!=i.keyCode&&38!=i.keyCode||$(".backbutton").trigger("click"),32==i.keycode&&(console.log("spacebar"),$(".photoinfo").toggleClass("hidden")),37==i.keyCode?$("#mainimage").hasClass("visible")?$(".photonav.prev").trigger("click"):$("#collectioninfo .prev a").trigger("click"):39==i.keyCode&&($("#mainimage").hasClass("visible")?$(".photonav.next").trigger("click"):$("#collectioninfo .next a").trigger("click"))}),"standalone"in window.navigator&&window.navigator.standalone&&$("a").on("click",function(i){i.preventDefault();var e=$(this).attr("href");void 0!=e&&"#"!=e.substr(0,1)&&void 0==$(this).attr("data-method")&&(window.location=e)})});
